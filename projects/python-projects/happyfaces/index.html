<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Python HappyFaces | Crystal H. Hansen </title> <meta name="author" content="Crystal H. Hansen"> <meta name="description" content="A local run/flask integration of the distilbert pretrained positive negative classification."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cryhansen.github.io/projects/python-projects/happyfaces/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Crystal</span> H. Hansen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Python HappyFaces</h1> <p class="post-description">A local run/flask integration of the distilbert pretrained positive negative classification.</p> </header> <article> <h3 id="python-collection">Python Collection</h3> <ul> <li>[Site A ‚Äì Happy Faces ] (/projects/python-projects/happyfaces/)</li> <li><a href="/projects/python-projects/flask-generate-sales">Site B - Flask Sales Generator </a></li> <li><a href="/projects/python-projects/license-spring-api">Site C ‚Äì License Spring API</a></li> <li><a href="/projects/python-projects/scraper-master/">Site D ‚Äì Scraper</a></li> </ul> <h3 id="python-repository">Python Repository</h3> <ul> <li><a href="https://github.com/cryshansen/happyfaces" rel="external nofollow noopener" target="_blank">Happy Faces API</a></li> </ul> <p>Exploration of the Python stack api application development in combination and to enhance happy2be api model with the Bert Sentiment distributed model using happyfaces <strong><em>huggingface/hub/models‚Äìdistilbert-base-uncased-finetuned-sst-2-english</em></strong>. While the happy2be model does not have the proper distilbert this app utilizes this feature. It is intended to be deployed in an AWS EC2 instance for access.</p> <p>This repo explores the use of two different application packages for working with python apis. One file represents the <strong><em>FastAPI</em></strong> and the second uses <strong><em>Flask</em></strong> for the app build of for deployement to aws. This package is the python subset of the happy2be where it is intended to be called and information performed and sentiment sent in the back end to support the prompt / sentiment matching. of the happy2be.</p> <p>‚úÖ Here‚Äôs what this project is doing: üß† Function. Loads a sentiment classification model from Hugging Face (distilbert-base-uncased-finetuned-sst-2-english)</p> <p>Sets up a FastAPI app with:</p> <p>A home route (GET /) for testing A predict route (POST /predict/) that accepts a string input and returns the sentiment analysis result</p> <p>üß™ At runtime It runs two test sentences and prints their results when the app starts. It runs continuously as a web service using FastAPI (e.g., via uvicorn or hypercorn).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/system-diagram-sentiment-analysis-480.webp 480w,/assets/img/happyfaces/system-diagram-sentiment-analysis-800.webp 800w,/assets/img/happyfaces/system-diagram-sentiment-analysis-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/system-diagram-sentiment-analysis.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Happy Faces Mind Map" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> System diagram -- sentiment analysis system. </div> <div class="row"> <div class="col-12"> <table style="width:100%; border-collapse: collapse; font-family: Arial, sans-serif;"> <thead style="background-color: #f2f2f2;"> <tr> <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">File</th> <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Purpose</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 12px;"><code>WorkingModel.py</code></td> <td style="border: 1px solid #ddd; padding: 12px;">Downloads <strong>base DistilBERT</strong> (no classification head). Good for fine-tuning or using embeddings.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 12px;"><code>convertModel.py</code></td> <td style="border: 1px solid #ddd; padding: 12px;">Forces download and logs path for <strong>fine-tuned</strong> <code>distilbert-base-uncased-finetuned-sst-2-english</code>. Used for ETL or permanent local use.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 12px;"><code>WorkingTokenizer.py</code></td> <td style="border: 1px solid #ddd; padding: 12px;">Implements a <strong>FastAPI</strong> server with <code>/</code> and <code>/predict/</code> endpoints using HuggingFace pipeline for sentiment.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 12px;"><code>happyface.py</code></td> <td style="border: 1px solid #ddd; padding: 12px;">Implements a <strong>Flask API</strong> for POSTing text to <code>/analyze</code> using the same tokenizer and pipeline. Simple wrapper to serve the model.</td> </tr> </tbody> </table> </div> </div> <div class="row my-5"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/user-flow-480.webp 480w,/assets/img/happyfaces/user-flow-800.webp 800w,/assets/img/happyfaces/user-flow-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/user-flow.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="User Flow" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/state-diagram-480.webp 480w,/assets/img/happyfaces/state-diagram-800.webp 800w,/assets/img/happyfaces/state-diagram-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/state-diagram.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="State Diagram" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/class-diagram-480.webp 480w,/assets/img/happyfaces/class-diagram-800.webp 800w,/assets/img/happyfaces/class-diagram-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/class-diagram.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Class Diagram" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Caption photos easily. On the left, a road goes through a tunnel. Middle, State Diagram Visualizes how user input transitions through various states in your system. Right, Class Diagram Describes the main classes and their relationships (useful if you expand your app with more features). </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/proper-mind-map-480.webp 480w,/assets/img/happyfaces/proper-mind-map-800.webp 800w,/assets/img/happyfaces/proper-mind-map-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/proper-mind-map.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Happy Faces Mind Map" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This image can also have a caption. It's like magic. </div> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/sequence-diagram-480.webp 480w,/assets/img/happyfaces/sequence-diagram-800.webp 800w,/assets/img/happyfaces/sequence-diagram-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/sequence-diagram.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Sequence Diagram" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/happyfaces/logic-flow-fastapp-480.webp 480w,/assets/img/happyfaces/logic-flow-fastapp-800.webp 800w,/assets/img/happyfaces/logic-flow-fastapp-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/happyfaces/logic-flow-fastapp.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Logic Fast API" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Sequence Diagram. llustrates how components (like the user, API, tokenizer, and model) interact over time. On the right, the logic flow diagram of the fast API. The Flask version is identical in flow. </div> <p>The code is very simple for building out a small support API endpoint to connect sentiment analysis on message prompts.</p> <p>Snippet of a python route included in the app is below:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/analyze</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">analyze</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">json</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">jsonify</span><span class="p">({</span><span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">No text provided</span><span class="sh">"</span><span class="p">}),</span> <span class="mi">400</span>

    <span class="n">result</span> <span class="o">=</span> <span class="nf">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">jsonify</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sh">"</span><span class="s">0.0.0.0</span><span class="sh">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5001</span><span class="p">)</span>

</code></pre></div></div> <p>üìù Notes / Suggestions ‚úÖ FastAPI vs Flask: You‚Äôre testing two server frameworks for the same model. You can unify into one later. ‚úÖ Model portability: Good idea with <strong><em>support/convertModel.py</em></strong> to find and optionally move model files. ‚úÖ Tokenizer and model loading are correctly structured in both web apps. ‚úÖ Ideal next step: Add test cases + Dockerize for portability if deploying to the AWS Instance environment.</p> <p>Visit the python repo for more details:</p> <ul> <li><a href="https://github.com/cryshansen/happyfaces" rel="external nofollow noopener" target="_blank">Happy Faces API</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2025 Crystal H. Hansen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>