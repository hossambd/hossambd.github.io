<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="dNntxSC0mShXeLWFqw9ftBD0usXNQi3snCahDaJJfes"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Why Branch Discipline in Git Isn’t Optional (And How It Saved This Auth Refactor) | Crystal H. Hansen </title> <meta name="author" content="Crystal H. Hansen"> <meta name="description" content="This Post describes the use of git to manage two branches of ongoing work and how to do it."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, Crystal Hansen Developer portfolio, developer, Crystal Hansen Developer, Crystal Hansen's Developer site."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cryhansen.github.io/blog/2026/why-github-branch-discipline-in-git-isnt-optional/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" integrity="sha256-Oppd74ucMR5a5Dq96FxjEzGF7tTw2fZ/6ksAqDCM8GY=" crossorigin="anonymous" media="screen and (prefers-color-scheme: light)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" integrity="sha256-nyCNAiECsdDHrr/s2OQsp5l9XeY2ZJ0rMepjCT2AkBk=" crossorigin="anonymous" media="screen and (prefers-color-scheme: dark)"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/css/diff2html.min.css" integrity="sha256-IMBK4VNZp0ivwefSn51bswdsrhk0HoMTLc2GqFHFBXg=" crossorigin="anonymous"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Crystal</span> H. Hansen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Why Branch Discipline in Git Isn’t Optional (And How It Saved This Auth Refactor)</h1> <p class="post-meta"> Created on January 20, 2026 </p> <p class="post-tags"> <a href="/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/tag/git"> <i class="fa-solid fa-hashtag fa-sm"></i> git</a>   <a href="/blog/tag/git-rebase"> <i class="fa-solid fa-hashtag fa-sm"></i> git-rebase</a>   <a href="/blog/tag/git-stash"> <i class="fa-solid fa-hashtag fa-sm"></i> git-stash</a>   <a href="/blog/tag/git-branch"> <i class="fa-solid fa-hashtag fa-sm"></i> git-branch</a>   <a href="/blog/tag/github"> <i class="fa-solid fa-hashtag fa-sm"></i> github</a>   <a href="/blog/tag/devops"> <i class="fa-solid fa-hashtag fa-sm"></i> devops</a>   ·   <a href="/blog/category/github-posts"> <i class="fa-solid fa-tag fa-sm"></i> github-posts</a>   <a href="/blog/category/devops-posts"> <i class="fa-solid fa-tag fa-sm"></i> devops-posts</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="why-branch-discipline-in-git-isnt-optional-and-how-it-saved-this-auth-refactor">Why Branch Discipline in Git Isn’t Optional (And How It Saved This Auth Refactor)</h2> <p>When people first learn Git, branching often feels optional — something you do sometimes, mostly when things get messy.</p> <p>In reality, branch discipline is what prevents messes from ever happening.</p> <p>This post explains why branches matter, when to split work, and how Git gives you escape hatches — using a real refactor from a cookie-based auth system as the example. The cookie based system is part of a Login Feature React Post series. While switching from a MVP of localstorage to cookie authentication base, development needs to pause with normal branch cycle processes. See the github branch usage at <a href="https://github.com/cryshansen/login-feature-react/" rel="external nofollow noopener" target="_blank">Login Feature</a> and review the branches in dropdown. These branches match the posts associated to the code base.</p> <hr> <h3 id="the-general-problem">The General Problem</h3> <p>Modern features aren’t linear. A single “feature” often involves:</p> <ul> <li>Refactoring existing code</li> <li>Changing types/contracts</li> <li>Removing old files</li> <li>Adding tests</li> <li>Adjusting tooling (ESLint, Vitest, etc.)</li> </ul> <p>If you do all of that on one branch, you create problems:</p> <ul> <li>You can’t publish intermediate posts</li> <li>You can’t reason about regressions</li> <li>You can’t roll back safely</li> <li>You can’t explain what changed and why</li> </ul> <p>Git branches are how you control narrative and risk.</p> <hr> <h3 id="the-real-example-cookie-based-auth--tests">The Real Example: Cookie-Based Auth + Tests</h3> <pre><code class="language-mermaid">timeline
    title Auth Refactor → Testing Evolution

    section post/post5b-cookie-auth
      Cookie-only auth context (/me) : AuthContext.tsx
      Remove token persistence        : localStorage cleanup
      Message contract enforced       : success | error | warning
      Delete legacy files             : AuthContext.jsx

    section post/post6-testing
      Add MSW handlers                : /me, /login, /logout
      Add Vitest config               : vitest.config.js
      Write contract tests            : AuthContext.test.tsx
</code></pre> <h4 id="the-goal">The goal</h4> <p><strong><em>Post 5b: Convert auth to cookie-only, /me identity changes.</em></strong> Normally, I check in to a new branch when the code is finalized then merge with main, then create a new branch and pull main into it. This is a choice so people can follow along on the login-feature post series via the code. However I still wasnt convinced the cookie auth was a clean code body. The switching feature from localstorage to cookie was over-kill for the projects final product. This meant a refactor was likely. I didnt want to merge it into main until i was certain this was a clean copy of cookie based authentication. It was clearly necessary to separate at this time. The biggest reason was the changes made to implement typescript for field mappings and separation of direct api calls within this cookie auth system.</p> <p><strong><em>Post 6: Add contract tests using MSW + Vitest</em></strong> At the same time, working on code standards and testing files to get a better sense of the change impact, I created branch 6 to correlate those changes. This means, post6 is ahead of 5b and we need to merge the changed files back into post5-cookie-auth. We dont want to include the testing files in 5b however. These are related — but they are not the same change.</p> <hr> <h3 id="what-went-wrong-on-purpose">What Went Wrong (On Purpose)</h3> <p>During the cookie auth code completion, the idea of switching between the auth <code class="language-plaintext highlighter-rouge">types</code> (localStorage vs Cookie )many development changes occurred:</p> <ul> <li>The AuthContext was converted from JS → TSX</li> <li>Token logic was removed</li> <li>/me became the single identity resolver</li> <li>Message contracts were enforced</li> <li>Old files were deleted</li> <li>Test infrastructure was added</li> </ul> <p>At one point, the working tree looked like this:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>new file:   src/context/AuthContext.tsx
deleted:    src/context/AuthContext.jsx
deleted:    src/_tests_disabled/slugify.test.js
modified:   auth.service.ts
modified:   auth.types.ts
untracked:  src/features/_tests_/
untracked:  vitest.config.js
</code></pre></div></div> <p>This is the exact moment where branch discipline really matters.</p> <hr> <h3 id="the-key-insight">The Key Insight</h3> <p>Not everything that changed belongs in the same post. In this example our branches are intended to replicate the blog posting of code for the feature. (5b-cookie-auth vs post6-testing)</p> <ul> <li>Auth refactor = Post 5b</li> <li>Tests + tooling = Post 6</li> </ul> <p>So we split them.</p> <hr> <h3 id="the-correct-strategy">The Correct Strategy</h3> <pre><code class="language-mermaid">gitGraph
    commit id: "main"
    branch post/post5b-cookie-auth
    checkout post/post5b-cookie-auth
    commit id: "cookie auth refactor"

    branch post/post6-testing
    checkout post/post6-testing
    commit id: "testing setup"
    commit id: "auth contract tests"


</code></pre> <h4 id="keep-post-5b-pure">Keep Post 5b pure</h4> <p>Only include:</p> <ul> <li>Cookie-only AuthContext</li> <li>/me identity resolution</li> <li>Message contract cleanup</li> <li>File deletions related to auth</li> </ul> <p>That work was committed and pushed to: post/post5b-cookie-auth</p> <hr> <h4 id="move-ahead-without-fear">Move ahead without fear</h4> <p>A new branch was created: post/post6-testing</p> <p>This branch is allowed to:</p> <ul> <li>Add MSW handlers</li> <li>Add Vitest config</li> <li>Add contract tests</li> <li>Modify tooling</li> <li>No pressure to “finish” everything at once.</li> </ul> <hr> <h4 id="the-recovery-moment-this-is-the-lesson">The Recovery Moment (This Is the Lesson)</h4> <p>Even after branching, things got mixed temporarily.</p> <p>Instead of panic:</p> <ul> <li>We cherry-picked the correct commit back into post/post5b-cookie-auth</li> <li>Git detected the commit already existed during rebase</li> <li>The history stayed clean</li> <li>Nothing broke</li> </ul> <p>This is Git doing its job.</p> <hr> <h4 id="why-this-matters">Why This Matters</h4> <p>Without branches:</p> <ul> <li>You rewrite history</li> <li>You squash unrelated ideas</li> <li>You lose teaching clarity</li> <li>You risk regressions</li> </ul> <p>With branches:</p> <ul> <li>Each post has a clean narrative</li> <li>Refactors are explainable</li> <li>Tests land when they’re ready</li> <li>You can pause and resume safely</li> </ul> <hr> <h4 id="the-mental-model-that-helps">The Mental Model That Helps</h4> <p>Think of branches like chapters in a book:</p> <ul> <li>Each chapter should stand on its own</li> <li>You can reference earlier chapters</li> <li>You shouldn’t leak future material backward</li> </ul> <p>Git branches enforce that discipline technically, so you don’t have to rely on memory.</p> <hr> <h3 id="final-state-the-ideal-outcome">Final State (The Ideal Outcome)</h3> <ul> <li>post/post5b-cookie-auth → Cookie auth refactor only</li> <li>post/post6-testing → Contract tests + MSW + Vitest</li> <li>Clean history</li> <li>Clear posts</li> <li>No rewrites</li> <li>No stress</li> </ul> <hr> <h3 id="takeaway">Takeaway</h3> <p>Git isn’t just version control.</p> <p>It’s:</p> <ul> <li>Architecture protection</li> <li>Teaching structure</li> <li>Fear removal</li> <li>A safety net for thinking clearly</li> </ul> <p>If your feature feels “too big for one commit” — it is. Split it early. Your future self (and your readers) will thank you.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/react-login-07-include-login-feature-in-another-app/">React Login Series - Reusing the Feature in Another App | Part 7</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/post-6-testing-suite/">React Login Series - Login Feature Complete Test Suite | Part 6b</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/what-github-doesnt-teach/">What Git Never Explains -- Stacked Branches &amp; Merge Order</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/react-login-06-testing-login-feature/">React Login Series - Testing the Login Feature (RTL + Jest) | Part 6</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2026/react-login-05-auth-context-cookie-persistence/">React Login Series - Auth Context Cookie Auth | Part 5b</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Crystal H. Hansen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/diff2html@3.4.47/bundles/js/diff2html-ui.min.js" integrity="sha256-eU2TVHX633T1o/bTQp6iIJByYJEtZThhF9bKz/DcbbY=" crossorigin="anonymous"></script> <script defer src="/assets/js/diff2html-setup.js?80a6e52ce727518bbd3aed2bb6ba5601" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>